# üìå Indexing in DBMS

---

## What is Indexing in DBMS?

Indexing is a technique used in databases to find data faster.

Instead of searching every row in a table, the database uses an index table that tells it where the required data is stored.

Think of an index as a shortcut to reach data quickly.

---

## Why Do We Need Indexing?

### Real-Life Example: Book Index üìò

Imagine a 1,000-page textbook and you want to find the topic **‚Äúxyz‚Äù**.

### Without Index

* You flip pages one by one
* Very slow
* Time-consuming
* Frustrating

### With Index

* You go to the index page
* Look for ‚Äúxyz‚Äù
* It shows pages **448‚Äì490**
* You directly jump there

üëâ Much faster and efficient

---

### Same Concept in Databases

* A database table may have millions of records
* Searching row by row is very slow
* Indexing helps the DBMS directly locate the record

---

## What Does an Index Contain?

An index table has two columns:

### 1. Search Key

* A copy of a key or non-key attribute from the table

### 2. Pointer (Address)

* Stores the disk block address where the actual data exists

```
Search Key   ‚Üí   Disk Block Address
```

The index table is always **sorted**, which makes searching faster.

---

## How Indexing Helps?

### 1. Faster Data Retrieval

* Avoids full table scan
* Reduces disk I/O operations

### 2. Faster Sorting (ORDER BY)

* If an index exists, DBMS reads data already in order

### 3. Faster Grouping (GROUP BY)

* Grouping becomes easier when data is indexed

---

## Types of Indexing (Big Picture)

```
Indexing
‚îÇ
‚îú‚îÄ‚îÄ Single-Level Indexing
‚îÇ   ‚îú‚îÄ‚îÄ Primary Index
‚îÇ   ‚îú‚îÄ‚îÄ Clustered Index
‚îÇ   ‚îî‚îÄ‚îÄ Secondary Index
‚îÇ
‚îî‚îÄ‚îÄ Multi-Level Indexing
```

---

## Dense Index vs Sparse Index (Very Important)

### Dense Index

* Index entry for every record
* Faster lookups
* Uses more storage

### Sparse Index

* Index entry for only some records (usually one per block)
* Smaller index
* Slightly slower than dense index

---

## Dense Index vs Sparse Index (With Proper Tabular Data)

---

## 1. Dense Index

### What is a Dense Index?

A Dense Index has an index entry for every record in the data table.

* Each search key value has a direct pointer to the record
* Works even when data is **NOT sorted**
* Faster for exact searches

---

### Example: Data Table (Unsorted)

#### STUDENT TABLE

| RollNo | Name  |
| ------ | ----- |
| 3      | Raghu |
| 1      | Ram   |
| 5      | Raj   |
| 2      | Shyam |
| 4      | Riti  |

---

### Dense Index Table (Index entry for EVERY record)

| Search Key (RollNo) | Pointer (Block + Row) |
| ------------------- | --------------------- |
| 1                   | B1                    |
| 2                   | B2                    |
| 3                   | B1                    |
| 4                   | B3                    |
| 5                   | B2                    |

‚úî Every roll number has an index entry
‚úî Index directly points to the exact record

---

### How Searching Works (Dense Index)

* Search for **RollNo = 4**
* DBMS searches index table
* Finds pointer **B3**
* Directly fetches the record

üëâ No extra searching needed

---

### Key Characteristics of Dense Index

| Feature      | Dense Index      |
| ------------ | ---------------- |
| Index entry  | For every record |
| Data order   | Can be unsorted  |
| Search speed | Very fast        |
| Storage      | High             |
| Maintenance  | Costly           |

---

### When to Use Dense Index?

* Secondary indexing
* Random access is frequent
* Exact match queries

---

## 2. Sparse Index

### What is a Sparse Index?

A Sparse Index does **NOT** store index entries for every record.

* Stores one entry per data block
* Data must be sorted
* Smaller index size

---

### Example: Data Table (Sorted)

#### STUDENT TABLE (Sorted by RollNo)

| RollNo | Name  | Block |
| ------ | ----- | ----- |
| 1      | Ram   | B1    |
| 2      | Shyam | B1    |
| 3      | Raghu | B1    |
| 4      | Riti  | B2    |
| 5      | Raj   | B2    |
| 6      | Rahul | B2    |

---

### Sparse Index Table (One entry per block)

| Search Key (First Key in Block) | Block Pointer |
| ------------------------------- | ------------- |
| 1                               | B1            |
| 4                               | B2            |

‚úî Only 2 index entries
‚úî Each entry points to a block, not an individual record

---

### How Searching Works (Sparse Index)

* Search for **RollNo = 5**
* DBMS checks sparse index
* Finds that **5 lies between 4 and next value**
* Goes to **Block B2**
* Searches inside block to find **RollNo = 5**

üëâ Extra search inside block is required

---

### Key Characteristics of Sparse Index

| Feature      | Sparse Index          |
| ------------ | --------------------- |
| Index entry  | For some records only |
| Data order   | Must be sorted        |
| Search speed | Slightly slower       |
| Storage      | Low                   |
| Maintenance  | Cheap                 |

---

### When to Use Sparse Index?

* Primary indexing
* Large sorted tables
* Range queries

---

## Dense Index vs Sparse Index (Side-by-Side Comparison)

| Feature            | Dense Index     | Sparse Index    |
| ------------------ | --------------- | --------------- |
| Index entries      | Every record    | One per block   |
| Data sorted?       | Not required    | Required        |
| Pointer points to  | Exact record    | Data block      |
| Storage space      | More            | Less            |
| Search speed       | Faster          | Slightly slower |
| Extra block search | No              | Yes             |
| Used in            | Secondary index | Primary index   |

---

### One-Line Memory Trick (Exam Gold ‚≠ê)

* **Dense Index ‚Üí ‚ÄúEvery record has an index entry‚Äù**
* **Sparse Index ‚Üí ‚ÄúOnly block-level index entries‚Äù**

---

## 1. Primary Index

### What is a Primary Index?

A Primary Index is an index created on the **primary key** of a table.

* Data must be sorted on the primary key
* Uses Sparse Indexing
* Only one primary index per table

---

### Example: Data Table (Sorted by Primary Key)

#### STUDENT TABLE (Primary Key = RollNo)

| RollNo | Name  | Block |
| ------ | ----- | ----- |
| 1      | Ram   | B1    |
| 2      | Shyam | B1    |
| 3      | Raghu | B1    |
| 4      | Riti  | B2    |
| 5      | Raj   | B2    |
| 6      | Rahul | B2    |

---

### Primary Index Table (Sparse Index)

| Search Key (First PK in Block) | Block Pointer |
| ------------------------------ | ------------- |
| 1                              | B1            |
| 4                              | B2            |

‚úî One index entry per block
‚úî Index is small and efficient

---

### How Searching Works (Primary Index)

* Search for **RollNo = 5**
* DBMS checks primary index
* Finds that **5 lies in Block B2**
* Searches inside **B2**
* Retrieves record **(5, Raj)**

---

### Key Characteristics of Primary Index

| Feature       | Primary Index |
| ------------- | ------------- |
| Index key     | Primary key   |
| Data order    | Sorted        |
| Index type    | Sparse        |
| Index entries | One per block |
| Index count   | Only one      |
| Storage       | Low           |

---

## 2. Clustered Index (Clustering Index)

### What is a Clustered Index?

A Clustered Index is created on a **non-key attribute**, and the table is **physically sorted** based on that attribute.

* Multiple records can have the same key value
* Uses Dense Indexing
* Data with same values stored together (cluster)

---

### Example: Data Table (Sorted by Age ‚Äì Non-Key)

#### STUDENT TABLE

| Age | Name  | Block |
| --- | ----- | ----- |
| 18  | Ram   | B1    |
| 18  | Shyam | B1    |
| 19  | Raghu | B1    |
| 20  | Riti  | B2    |
| 20  | Raj   | B2    |
| 21  | Rahul | B2    |

---

### Clustered Index Table (Dense Index)

| Search Key (Age) | Block Pointer |
| ---------------- | ------------- |
| 18               | B1            |
| 19               | B1            |
| 20               | B2            |
| 21               | B2            |

‚úî Index entry for each unique non-key value
‚úî Records with same Age are grouped

---

### How Searching Works (Clustered Index)

* Search for **Age = 20**
* DBMS searches clustered index
* Finds pointer to **Block B2**
* Retrieves all records with **Age = 20**

---

### Key Characteristics of Clustered Index

| Feature        | Clustered Index   |
| -------------- | ----------------- |
| Index key      | Non-key attribute |
| Data order     | Sorted            |
| Index type     | Dense             |
| Duplicate keys | Allowed           |
| Storage        | Medium            |

---

## 3. Secondary Index

### What is a Secondary Index?

A Secondary Index is created on a column that is **not physically sorted**.

* Can be on key or non-key
* Data remains unsorted
* Uses Dense Indexing
* Multiple secondary indexes allowed

---

### Example: Data Table (Unsorted)

#### STUDENT TABLE

| RollNo | Name  | City   |
| ------ | ----- | ------ |
| 3      | Raghu | Delhi  |
| 1      | Ram   | Mumbai |
| 5      | Raj   | Delhi  |
| 2      | Shyam | Pune   |
| 4      | Riti  | Mumbai |

---

### Secondary Index Table (Dense Index on City)

| Search Key (City) | Record Pointers |
| ----------------- | --------------- |
| Delhi             | ‚Üí (3), (5)      |
| Mumbai            | ‚Üí (1), (4)      |
| Pune              | ‚Üí (2)           |

‚úî One index entry per search key value
‚úî Points to multiple records

---

### How Searching Works (Secondary Index)

* Search for **City = Mumbai**
* DBMS checks secondary index
* Gets pointers ‚Üí **(1, 4)**
* Fetches both records directly

---

### Key Characteristics of Secondary Index

| Feature     | Secondary Index  |
| ----------- | ---------------- |
| Index key   | Key or non-key   |
| Data order  | Unsorted         |
| Index type  | Dense            |
| Index count | Multiple allowed |
| Storage     | High             |

---

## Primary vs Clustered vs Secondary Index (Final Comparison)

| Feature            | Primary Index | Clustered Index | Secondary Index |
| ------------------ | ------------- | --------------- | --------------- |
| Created on         | Primary key   | Non-key         | Key / Non-key   |
| Data order         | Sorted        | Sorted          | Unsorted        |
| Index type         | Sparse        | Dense           | Dense           |
| Duplicate values   | No            | Yes             | Yes             |
| No. of indexes     | One           | One             | Many            |
| Extra block search | Yes           | No              | No              |

---

### Memory Trick (Very Useful for Exams)

* **Primary Index ‚Üí PK + Sorted + Sparse**
* **Clustered Index ‚Üí Non-Key + Sorted + Dense**
* **Secondary Index ‚Üí Unsorted + Dense**

---

## Single-Level vs Multi-Level Indexing

### Single-Level Indexing

* One index table
* Works well for small databases

### Multi-Level Indexing

Used when index itself becomes very large.

#### How it Works

* First level ‚Üí points to data blocks
* Second level ‚Üí points to first-level index blocks
* Index on index

#### Benefit

* Reduces disk I/O
* Faster searching in large databases

---

## Clustered vs Non-Clustered Index (MySQL Note)

### Clustered index

* Automatically created with PRIMARY KEY
* Only one allowed

### Non-clustered index

* Created manually
* Multiple allowed

**MySQL does not allow explicit creation of multiple clustered indexes.**

---

## Index Summary Table

| Type              | Key           | Data Order | Index Type   |
| ----------------- | ------------- | ---------- | ------------ |
| Primary Index     | Primary Key   | Sorted     | Sparse       |
| Clustered Index   | Non-Key       | Sorted     | Dense        |
| Secondary Index   | Key / Non-Key | Unsorted   | Dense        |
| Sparse Index      | Any           | Sorted     | Partial      |
| Dense Index       | Any           | Any        | Full         |
| Multi-Level Index | Any           | Any        | Hierarchical |
