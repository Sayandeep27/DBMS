# ğŸ” Lock-Based Protocols in DBMS

A **complete, beginner-friendly, and exam-oriented guide** to **Lock-Based Concurrency Control in Database Management Systems (DBMS)**.
This README is **GitHub-ready**, written in **simple language**, with **clear headings, tables, examples, and rules**.

---

## ğŸ“Œ Why Lock-Based Protocols Are Needed

When multiple transactions execute **concurrently**, problems may occur:

* Dirty Read
* Lost Update
* Inconsistent Data
* Cascading Rollback

ğŸ‘‰ **Lock-based protocols** are used to **control concurrent access** and ensure **data consistency and isolation**.

---

## ğŸ”‘ What Is a Lock?

A **lock** is a mechanism that **restricts access** to a data item.

* A transaction **must acquire a lock before accessing data**
* If the lock is unavailable, the transaction **waits**

Locks help maintain the **Isolation** property of **ACID**.

---

## ğŸ” Lock-Based Protocol (Basic Concept)

Rules:

1. Transaction must **lock data before read/write**
2. Lock is **released after use**
3. Conflicting operations are **not allowed simultaneously**

---

## 1ï¸âƒ£ Binary Lock

### What Is a Binary Lock?

A **binary lock** has only **two states**.

| State | Meaning  |
| ----- | -------- |
| 0     | Unlocked |
| 1     | Locked   |

### Rules

* If data is locked â†’ **no other transaction** can access it
* No distinction between read and write

### Example

```text
T1 locks X
T2 tries to read X â†’ WAIT
T1 unlocks X
T2 proceeds
```

### Drawback

âŒ Very restrictive
âŒ Low concurrency

ğŸ‘‰ Rarely used in real DBMS

---

## 2ï¸âƒ£ Shared and Exclusive Locks

To improve concurrency, DBMS uses **two lock types**.

---

## ğŸ”¹ Shared Lock (S-Lock)

* Used for **READ** operations
* Multiple transactions can **read simultaneously**
* No transaction can write

### Rule

```text
READ(X) â†’ Acquire S-Lock on X
```

---

## ğŸ”¹ Exclusive Lock (X-Lock)

* Used for **WRITE** operations
* Only **one transaction** allowed
* Blocks both read and write by others

### Rule

```text
WRITE(X) â†’ Acquire X-Lock on X
```

---

## 3ï¸âƒ£ Lock Compatibility Matrix

| Existing Lock | Request S     | Request X     |
| ------------- | ------------- | ------------- |
| **S**         | âœ… Allowed     | âŒ Not Allowed |
| **X**         | âŒ Not Allowed | âŒ Not Allowed |

### Key Points

* Multiple readers allowed
* Writer needs exclusive access

---

## 4ï¸âƒ£ Example: S and X Lock Working

Initial Value:

```text
X = 100
```

Transactions:

```text
T1: READ(X)
T2: READ(X)
T3: WRITE(X)
```

Execution:

1. T1 gets S-lock â†’ Allowed
2. T2 gets S-lock â†’ Allowed
3. T3 requests X-lock â†’ WAIT
4. T1 & T2 release S-lock
5. T3 gets X-lock and writes

---

## 5ï¸âƒ£ Lock Conversion

### ğŸ”¹ Lock Upgrade

* S â†’ X
* Allowed **only if no other S-lock exists**

### ğŸ”¹ Lock Downgrade

* X â†’ S
* Used after write operation

---

## 6ï¸âƒ£ Deadlock

### What Is Deadlock?

A **deadlock** occurs when transactions **wait forever** for each otherâ€™s locks.

### Deadlock Conditions

1. Mutual Exclusion
2. Hold and Wait
3. No Preemption
4. Circular Wait

---

### Deadlock Example

```text
T1 locks A
T2 locks B

T1 requests B â†’ WAIT
T2 requests A â†’ WAIT
```

ğŸ” Circular waiting â†’ **Deadlock**

---

## 7ï¸âƒ£ Deadlock Handling Techniques

### ğŸ”¹ Deadlock Prevention

* Timestamp-based methods
* Wait-Die scheme
* Wound-Wait scheme

### ğŸ”¹ Deadlock Detection

* Use **Wait-For Graph**
* Detect cycles

### ğŸ”¹ Deadlock Recovery

* Abort one transaction
* Rollback and restart

---

## 8ï¸âƒ£ Two-Phase Locking (2PL)

### What Is 2PL?

A protocol that ensures **conflict serializability** by dividing transaction execution into **two phases**.

---

### Phases of 2PL

#### ğŸ”¹ Growing Phase

* Acquire locks only
* No lock release allowed

#### ğŸ”¹ Shrinking Phase

* Release locks only
* No new lock acquisition allowed

ğŸ“Œ Once a lock is released â†’ **no new locks can be acquired**

---

### Example of 2PL

```text
T1:
Lock-S(A)
Lock-X(B)
READ(A)
WRITE(B)
Unlock(A)
Unlock(B)
```

âœ” All locks acquired before release

---

## 9ï¸âƒ£ Types of Two-Phase Locking

### ğŸ”¹ Basic 2PL

* Guarantees serializability
* Deadlock possible

---

### ğŸ”¹ Strict 2PL

* X-locks released **only after commit**
* Prevents cascading rollback
* Most widely used

---

### ğŸ”¹ Rigorous 2PL

* Both S and X locks released after commit
* Strongest isolation

---

## ğŸ”Ÿ Comparison Table

| Protocol     | Serializability | Deadlock | Cascading Rollback |
| ------------ | --------------- | -------- | ------------------ |
| Binary Lock  | Yes             | Yes      | Yes                |
| Basic 2PL    | Yes             | Yes      | Yes                |
| Strict 2PL   | Yes             | Yes      | No                 |
| Rigorous 2PL | Yes             | Yes      | No                 |

---

## ğŸ§  Exam-Oriented Summary

* Locks control concurrent access
* Binary locks are simple but inefficient
* S-lock â†’ Read, X-lock â†’ Write
* Deadlock occurs due to circular waiting
* 2PL guarantees conflict serializability
* Strict 2PL prevents cascading rollback

---

## ğŸ“ Ready for GitHub

âœ” Clean structure
âœ” Markdown compliant
âœ” Download-ready README.md
âœ” Suitable for exams, interviews, and projects

---

**Happy Learning ğŸš€**
